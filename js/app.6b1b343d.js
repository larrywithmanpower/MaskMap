(function(t){function e(e){for(var n,s,i=e[0],a=e[1],u=e[2],d=0,b=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&b.push(c[s][0]),c[s]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);l&&l(e);while(b.length)b.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,i=1;i<r.length;i++){var a=r[i];0!==c[a]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=r[0]))}return t}var n={},c={app:0},o=[];function s(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=n,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],a=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=a;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),c={id:"app"},o={class:"relative overflow-auto min-h-full"},s=Object(n["g"])("span",{class:"material-icons text-4xl"}," menu_open ",-1),i=[s];function a(t,e,r,s,a,u){var l=Object(n["p"])("AsideMenu"),d=Object(n["p"])("MaskMap"),b=Object(n["p"])("LightBox");return Object(n["k"])(),Object(n["f"])("div",c,[Object(n["g"])("div",o,[Object(n["g"])("a",{href:"#",class:"js-openAsideMenu openAsideMenu bg-blue-500 text-white align-middle pt-1\n        px-1 rounded-r-lg shadow hover:bg-red-500 z-20",onClick:e[0]||(e[0]=Object(n["x"])((function(){return u.openAsideMenu&&u.openAsideMenu.apply(u,arguments)}),["prevent"]))},i),Object(n["i"])(l,{class:"absolute top-0 bottom-0",ref:"menu",onTriggerMarkerPopup:u.openPopup},null,8,["onTriggerMarkerPopup"]),Object(n["i"])(d,{ref:"map"},null,512),Object(n["i"])(b,{class:"z-30"})])])}var u=r("5530"),l=(r("d81d"),r("5502")),d=(r("b0c0"),{class:"w-full md:w-6/12 lg:w-5/12 xl:w-4/12 shadow font-sans asideMenu js-asideMenu overflow-hidden md:pb-60 lg:pb-48"}),b={class:"container pt-2 pb-3 px-3 bg-blue-500 sticky top-0"},f=Object(n["g"])("span",{class:"material-icons"}," close ",-1),p=[f],h={class:"ssm:flex justify-between items-center mb-3 relative"},m=Object(n["g"])("span",{class:"material-icons absolute right-4 top-11 md:top-3.5 cursor-pointer"}," arrow_drop_down ",-1),g=Object(n["g"])("label",{for:"city",class:"text-white cursor-pointer block mb-2"},"縣市：",-1),j={class:"ssm:flex justify-between items-center mb-3 relative"},O=Object(n["g"])("span",{class:"material-icons absolute right-4 top-11 md:top-3.5 cursor-pointer"}," arrow_drop_down ",-1),y=Object(n["g"])("label",{for:"district",class:"text-white cursor-pointer block mb-2"},"行政區：",-1),w={class:"ssm:flex justify-between items-center relative"},k=Object(n["g"])("label",{for:"keywords",class:"text-white cursor-pointer block mb-2"},"關鍵字：",-1),x=Object(n["g"])("span",{class:"material-icons"}," close ",-1),v=[x],M={class:"container bg-white pt-2 pb-2 px-3 overflow-auto h-full scrollNone"},S=["onClick"],L=["innerHTML"],I={class:"flex items-center justify-between"},P={class:"text-xs text-gray-500 mb-2 w-8/12"},_={class:"mb-1.5"},$=Object(n["g"])("i",{class:"fas fa-head-side-mask mr-2"},null,-1),C={class:"mb-1.5"},q=Object(n["g"])("i",{class:"fas fa-baby mr-2.5"},null,-1),A={class:"mb-1.5"},B=["onClick"],D=Object(n["g"])("span",{class:"material-icons"}," info ",-1),T=Object(n["g"])("br",null,null,-1),z=Object(n["h"])(" 詳細資訊 "),H=[D,T,z];function K(t,e,r,c,o,s){return Object(n["k"])(),Object(n["f"])("div",d,[Object(n["g"])("div",b,[Object(n["g"])("a",{href:"#",class:"text-white hover:text-red-500",onClick:e[0]||(e[0]=Object(n["x"])((function(){return s.closeAsideMenu&&s.closeAsideMenu.apply(s,arguments)}),["prevent"]))},p),Object(n["g"])("ul",null,[Object(n["g"])("li",h,[m,g,Object(n["w"])(Object(n["g"])("select",{class:"rounded-full py-3 px-6 w-full ssm:w-5/6 placeholder-gray-500 border border-transparent\n            focus:outline-none focus:ring focus:ring-red-500 focus:ring-opacity-70 focus:border-transparent cursor-pointer",id:"city","onUpdate:modelValue":e[1]||(e[1]=function(t){return s.currCity=t})},[(Object(n["k"])(!0),Object(n["f"])(n["a"],null,Object(n["o"])(t.cityList,(function(t){return Object(n["k"])(),Object(n["f"])("option",{key:t},Object(n["q"])(t),1)})),128))],512),[[n["r"],s.currCity]])]),Object(n["g"])("li",j,[O,y,Object(n["w"])(Object(n["g"])("select",{class:"rounded-full py-3 px-6 w-full ssm:w-5/6 placeholder-gray-500 border border-transparent\n            focus:outline-none focus:ring focus:ring-red-500 focus:ring-opacity-70 focus:border-transparent cursor-pointer",id:"district","onUpdate:modelValue":e[2]||(e[2]=function(t){return s.currDistrict=t})},[(Object(n["k"])(!0),Object(n["f"])(n["a"],null,Object(n["o"])(t.districtList,(function(t){return Object(n["k"])(),Object(n["f"])("option",{key:t.id},Object(n["q"])(t.name),1)})),128))],512),[[n["r"],s.currDistrict]])]),Object(n["g"])("li",w,[k,Object(n["w"])(Object(n["g"])("input",{class:"rounded-full py-3 px-6 w-full ssm:w-5/6 placeholder-gray-500 border border-transparent\n            focus:outline-none focus:ring focus:ring-red-500 focus:ring-opacity-70 focus:border-transparent cursor-pointer",id:"keywords",placeholder:"請輸入關鍵字","onUpdate:modelValue":e[3]||(e[3]=function(t){return s.keywords=t})},null,512),[[n["s"],s.keywords]]),Object(n["g"])("a",{href:"#",class:"absolute right-4 top-12 ssm:top-3 text-black hover:text-red-500",onClick:e[4]||(e[4]=Object(n["x"])((function(t){return s.cleanKeywords()}),["prevent"]))},v)])])]),Object(n["g"])("ul",M,[(Object(n["k"])(!0),Object(n["f"])(n["a"],null,Object(n["o"])(t.filteredStores,(function(t){return Object(n["k"])(),Object(n["f"])("li",{class:"mb-3 pb-3 border-b cursor-pointer",key:t.id,onClick:function(e){return s.emitTrigger(t.id)}},[Object(n["g"])("h1",{class:"text-xl font-bold mb-1",innerHTML:s.keywordHighlight(t.name)},null,8,L),Object(n["g"])("div",I,[Object(n["g"])("ul",P,[Object(n["g"])("li",_,[$,Object(n["h"])(" 成人口罩： "+Object(n["q"])(t.mask_adult)+" 片 ",1)]),Object(n["g"])("li",C,[q,Object(n["h"])(" 孩童口罩： "+Object(n["q"])(t.mask_child),1)]),Object(n["g"])("li",A,Object(n["q"])(t.note),1),Object(n["g"])("li",null,"更新時間："+Object(n["q"])(t.updated),1)]),Object(n["g"])("button",{class:"p-3 border text-center hover:shadow rounded",onClick:function(e){return s.openInfoBox(t.id)}},H,8,B)])],8,S)})),128))])])}var R=r("3835"),U=(r("ac1f"),r("5319"),r("4d63"),r("25f0"),{watch:{districtList:function(t){var e=Object(R["a"])(t,1),r=e[0];this.currDistrict=r.name}},computed:Object(u["a"])({currCity:{get:function(){return this.$store.state.currCity},set:function(t){this.$store.commit("setcurrCity",t)}},currDistrict:{get:function(){return this.$store.state.currDistrict},set:function(t){this.$store.commit("setcurrDistrict",t)}},keywords:{get:function(){return this.$store.state.keywords},set:function(t){this.$store.commit("setKeywords",t)}},showModal:{get:function(){return this.$store.state.showModal},set:function(t){this.$store.commit("setshowModal",t)}},infoBoxStoreId:{get:function(){return this.$store.state.infoBoxStoreId},set:function(t){this.$store.commit("setInfoBoxStoreId",t)}}},Object(l["c"])(["cityList","districtList","filteredStores"])),methods:{closeAsideMenu:function(){var t=document.querySelector(".js-openAsideMenu"),e=document.querySelector(".js-asideMenu");t.classList.remove("active"),e.classList.remove("active")},keywordHighlight:function(t){return t.replace(new RegExp(this.keywords,"g"),'<span class="text-red-500">'.concat(this.keywords,"</span>"))},openInfoBox:function(t){this.showModal=!0,this.infoBoxStoreId=t},cleanKeywords:function(){this.keywords=""},emitTrigger:function(t){this.$emit("triggerMarkerPopup",t),this.closeAsideMenu()}}});U.render=K;var V=U;Object(n["m"])("data-v-658a8844");var E={class:"modal-mask w-full h-full fixed top-0 left-0 z-10 table bg-black bg-opacity-60"},J={class:"modal-wrapper table-cell align-middle"},N={class:"modal-body"},F={class:"text-4xl mb-1 font-bold text-blue-500"},X=Object(n["g"])("hr",null,null,-1),Y=Object(n["g"])("h2",{class:"text-xl my-2 font-bold text-center"},"營業時間",-1),Z={class:"bg-blue-500 text-black mb-2 w-full"},G=Object(n["g"])("tr",{class:"text-left border-b-2 border-gray-300 text-white"},[Object(n["g"])("th",{class:"px-4 py-3"}),Object(n["g"])("th",{class:"px-4 py-3"},"一"),Object(n["g"])("th",{class:"px-4 py-3"},"二"),Object(n["g"])("th",{class:"px-4 py-3"},"三"),Object(n["g"])("th",{class:"px-4 py-3"},"四"),Object(n["g"])("th",{class:"px-4 py-3"},"五"),Object(n["g"])("th",{class:"px-4 py-3"},"六"),Object(n["g"])("th",{class:"px-4 py-3"},"日")],-1),Q={class:"bg-gray-100 border-b border-gray-200"},W=Object(n["g"])("td",{class:"px-4 py-3"},"早上",-1),tt={class:"bg-gray-100 border-b border-gray-200"},et=Object(n["g"])("td",{class:"px-4 py-3"},"中午",-1),rt={class:"bg-gray-100 border-b border-gray-200"},nt=Object(n["g"])("td",{class:"px-4 py-3"},"晚上",-1),ct={class:"mb-1"},ot={class:"text-blue-500"},st={class:"mb-1"},it=["href"],at={class:"text-blue-500"};function ut(t,e,r,c,o,s){return s.currStore?(Object(n["k"])(),Object(n["d"])(n["b"],{key:0,name:"modal"},{default:Object(n["v"])((function(){return[Object(n["w"])(Object(n["g"])("div",E,[Object(n["g"])("div",J,[Object(n["g"])("div",{class:"container mx-auto p-3 bg-white shadow rounded",onClick:e[0]||(e[0]=Object(n["x"])((function(t){return s.close()}),["self"]))},[Object(n["g"])("div",N,[Object(n["g"])("h1",F,Object(n["q"])(s.currStore.name),1),X,Y,Object(n["g"])("table",Z,[G,Object(n["g"])("tr",Q,[W,(Object(n["k"])(!0),Object(n["f"])(n["a"],null,Object(n["o"])(s.servicePeriods[0],(function(t,e){return Object(n["k"])(),Object(n["f"])("td",{class:"px-4 py-3",key:e},Object(n["q"])(t),1)})),128))]),Object(n["g"])("tr",tt,[et,(Object(n["k"])(!0),Object(n["f"])(n["a"],null,Object(n["o"])(s.servicePeriods[1],(function(t,e){return Object(n["k"])(),Object(n["f"])("td",{class:"px-4 py-3",key:e},Object(n["q"])(t),1)})),128))]),Object(n["g"])("tr",rt,[nt,(Object(n["k"])(!0),Object(n["f"])(n["a"],null,Object(n["o"])(s.servicePeriods[2],(function(t,e){return Object(n["k"])(),Object(n["f"])("td",{class:"px-4 py-3",key:e},Object(n["q"])(t),1)})),128))])]),Object(n["g"])("ul",null,[Object(n["g"])("li",ct,[Object(n["g"])("h2",ot,"地址："+Object(n["q"])(s.currStore.address),1)]),Object(n["g"])("li",st,[Object(n["g"])("a",{href:"tel:".concat(s.currStore.phone),class:"text-blue-500"},"電話："+Object(n["q"])(s.currStore.phone),9,it)]),Object(n["g"])("li",null,[Object(n["g"])("h2",at,"備註："+Object(n["q"])(s.currStore.note),1)])])])])])],512),[[n["t"],s.showModal]])]})),_:1})):Object(n["e"])("",!0)}Object(n["l"])();r("4de4"),r("1276"),r("fb6a");var lt={name:"Lightbox",computed:{showModal:{get:function(){return this.$store.state.showModal},set:function(t){this.$store.commit("setshowModal",t)}},infoBoxStoreId:{get:function(){return this.$store.state.infoBoxStoreId},set:function(t){this.$store.commit("setInfoBoxStoreId",t)}},currStore:function(){var t=this;return this.$store.state.stores.filter((function(e){return e.id===t.infoBoxStoreId}))[0]},servicePeriods:function(){var t,e=(null===this||void 0===this||null===(t=this.currStore)||void 0===t?void 0:t["service_periods"])||"";return e=e.replace(/N/g,"O").replace(/Y/g,"X"),e?[e.slice(0,7).split(""),e.slice(7,14).split(""),e.slice(14,21).split("")]:e}},methods:{close:function(){this.showModal=!1}}};r("f0cc"),r("6414");lt.render=ut,lt.__scopeId="data-v-658a8844";var dt=lt,bt={class:"mask-map relative h-screen\tw-full bg-gray-500",id:"mask-map"};function ft(t,e,r,c,o,s){return Object(n["k"])(),Object(n["f"])("div",bt)}r("159b"),r("99af"),r("7db0");var pt=r("e11e"),ht=r.n(pt),mt={name:"maskMap",data:function(){return{map:{},markers:[]}},watch:{currDistrictInfo:function(t){this.map.panTo(new ht.a.latLng(t.latitude,t.longitude))},filteredStores:function(t){var e=this;this.clearMarkers(),t.forEach((function(t){return e.addMarker(t)}))}},computed:{currDistrictInfo:function(){return this.$store.getters.currDistrictInfo},filteredStores:function(){return this.$store.getters.filteredStores}},methods:{addMarker:function(t){var e={iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},r=!0,n=ht.a.marker([t.longitude,t.latitude],e,r).addTo(this.map).bindPopup('\n          <h2 class="text-xl font-bold"> '.concat(t.name,' </h2>\n          <p class="mb-1.5">\n              <i class="fas fa-head-side-mask"></i>\n              成人口罩：\n              ').concat(t.mask_adult,' 片\n            </p>\n            <p class="mb-1.5">\n              <i class="fas fa-baby"></i>\n              孩童口罩：\n              ').concat(t.mask_child,"\n            </p>\n        "));n.markerId=t.id,n.lng=t.longitude,n.lat=t.latitude,this.markers.push(n)},clearMarkers:function(){var t=this;this.map.eachLayer((function(e){e instanceof ht.a.Marker&&t.map.removeLayer(e)})),this.markers=[]},triggerPopup:function(t){var e=this.markers.find((function(e){return e.markerId===t}));this.map.flyTo(new ht.a.LatLng(e.lng,e.lat),16),e.openPopup()}},mounted:function(){this.map=ht.a.map("mask-map",{center:[25.03,121.55],zoom:12}),ht.a.tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>',maxZoom:20}).addTo(this.map)}};mt.render=ft;var gt=mt,jt={components:{AsideMenu:V,LightBox:dt,MaskMap:gt},methods:Object(u["a"])(Object(u["a"])({openAsideMenu:function(){var t=document.querySelector(".js-openAsideMenu"),e=document.querySelector(".js-asideMenu");t.classList.add("active"),e.classList.add("active")}},Object(l["b"])(["fetchLocations","fetchPharmacies"])),{},{openPopup:function(t){this.$refs.map.triggerPopup(t)}}),mounted:function(){this.fetchLocations(),this.fetchPharmacies()}};r("c8a5");jt.render=a;var Ot,yt=jt,wt=r("1da1"),kt=r("ade3"),xt=(r("96cf"),r("caad"),r("2532"),r("d3b7"),Object(l["a"])({state:{currCity:"臺北市",currDistrict:"北投區",location:[],stores:[],keywords:"",showModal:!1,infoBoxStoreId:null},getters:{cityList:function(t){return t.location.map((function(t){return t.name}))},districtList:function(t){var e;return(null===(e=t.location.find((function(e){return e.name===t.currCity})))||void 0===e?void 0:e.districts)||[]},filteredStores:function(t){var e=t.stores;return t.keywords?e.filter((function(e){return e.name.includes(t.keywords)})):e.filter((function(e){return e.county===t.currCity&&e.town===t.currDistrict}))},currDistrictInfo:function(t,e){return e.districtList.find((function(e){return e.name===t.currDistrict}))||{}}},mutations:(Ot={setcurrCity:function(t,e){t.currCity=e},setcurrDistrict:function(t,e){t.currDistrict=e},setAreaLocation:function(t,e){t.location=e},setStores:function(t,e){t.stores=e},setKeywords:function(t,e){t.keywords=e},setshowModal:function(t,e){t.showModal=e},setInfoBoxSid:function(t,e){t.infoBoxSid=e}},Object(kt["a"])(Ot,"setKeywords",(function(t,e){t.keywords=e})),Object(kt["a"])(Ot,"setshowModal",(function(t,e){t.showModal=e})),Object(kt["a"])(Ot,"setInfoBoxStoreId",(function(t,e){t.infoBoxStoreId=e})),Ot),actions:{fetchLocations:function(t){return Object(wt["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.next=3,fetch("https://raw.githubusercontent.com/kurotanshi/mask-map/master/raw/area-location.json").then((function(t){return t.json()}));case 3:n=e.sent,r("setAreaLocation",n);case 5:case"end":return e.stop()}}),e)})))()},fetchPharmacies:function(t){return Object(wt["a"])(regeneratorRuntime.mark((function e(){var r,n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.next=3,fetch("https://kiang.github.io/pharmacies/json/points.json").then((function(t){return t.json()}));case 3:n=e.sent,c=n.features.map((function(t){return Object(u["a"])(Object(u["a"])({},t.properties),{},{latitude:t.geometry.coordinates[0],longitude:t.geometry.coordinates[1]})})),r("setStores",c);case 6:case"end":return e.stop()}}),e)})))()}},modules:{}}));r("ba8c");Object(n["c"])(yt).use(xt).mount("#app")},6414:function(t,e,r){"use strict";r("6a92")},"6a92":function(t,e,r){},"83ce":function(t,e,r){},"9ccc":function(t,e,r){},ba8c:function(t,e,r){},c8a5:function(t,e,r){"use strict";r("9ccc")},f0cc:function(t,e,r){"use strict";r("83ce")}});
//# sourceMappingURL=app.6b1b343d.js.map